<!-- 手冊封面 -->


<a href="images/NLA-Stride_LOGO2.png"><img src="images/NLA-Stride_LOGO2.png" width="250"></a>  

# 使用手冊（中文）

> 本手冊介紹 NLA-Stride Blender 外掛的相關功能與一些技巧，也有一些常見的已知問題回答。

---

## 📘 目錄

1. [快速開始](#-快速開始)  
2. [版更重點](#-版本更新重點)
3. [功能總覽](#gong-neng-zong-lan)      
4. [常見問題](#-常見問題) 
5. [其他](#-其他) 
6. [技術參考](#-技術參考)

---

## 🚀 快速開始

### 1. 外掛安裝

1. 使用 Blender 官方的安裝步驟即可 ( **[通用安裝教學](https://docs.blender.org/manual/en/latest/editors/preferences/addons.html)** )

2. 安裝外掛後，在 Blender 3D 檢視中的 **側欄 → 動畫** 頁籤可以看到 **NLA Stride Tool**。 
<br>![alt text](images/img_1001.png)



---

### 2. 選取具有動畫的物件  
<a href="images/img_1002.png">
  <img src="images/img_1002.png" width="650">
</a>  

選取一或多個含有動畫資料的物件。如果是標準動畫而非 NLA 動畫，請參閱「大量建立 NLA」說明。

---

### 3. 加入清單

![alt text](images/img_1003.png)

⚠️ 請注意：外掛是依靠清單運作，與即時選取物件無關。

---

### 4. NLA 對齊 / 錯位操作


<a href="images/img_1004.png"><img src="images/img_1004.png" width="650"></a>  

<a href="images/img_1005.png"><img src="images/img_1005.png" width="650"></a>  

<a href="images/img_1006.png"><img src="images/img_1006.png" width="650"></a>  


以上是 NLA 對齊與錯位功能示意。

---

### 5. 享受動畫魅力

<a href="images/DEMO_01.mp4">
  <img src="images/DEMO_01.gif" width="720">
</a>  

<a href="images/DEMO_02.mp4">
  <img src="images/DEMO_02.gif" width="720">
</a>  

<a href="images/DEM3_03.mp4">
  <img src="images/DEMO_03.gif" width="720">
</a>  

<a href="images/DEM3_04.mp4">
  <img src="images/DEMO_04.gif" width="720">
</a>  

此範例模型感謝台灣 [SANSUI / 山水品牌](https://www.sansuitw.com/?gad_source=1&gad_campaignid=23085773952&gbraid=0AAAAAoXC59ENhboAZDO-y0zK4yQpidtXM&gclid=CjwKCAiAybfLBhAjEiwAI0mBBscjnZOEYBBY127EypNMfnL1h_Vqm_HACczeJBOqMK-euDJFPb1iAxoC7rkQAvD_BwE)  贊助提供

---
## 🌟 版本更新重點  
#### v1.0.0 更新重點
- 清單的匯出 / 匯入 / 追加  
  ![alt text](images/v100_001.png)  
  1. 清單操作內增加三個功能
  2. 匯出及匯入清單都會以 *.json 為主
  3. 追加會追加在清單的最後
  4. 如有名稱重複，會以最先的為主
#### v0.9.8 更新重點  
- 對外發布初始版  
---
## 🧰 功能總覽 {#gong-neng-zong-lan}

#### 1. 資料來源 
<a id="gong-neng-zong-lan"></a>
![alt text](images/img_2001.png)

- A : 初始並加入所選    
  會清空清單資料後再添加 場景 中所選的物件  
  <br>
- B : 清空清單  
  清除清單內所有資料  
  <br>
- C : 動畫來源  
    目前支援有三種類型  
    -  物體動畫  
    -  shapeKey 動畫 ( 外形鍵 )  
    -  材質動畫
  <br>
- D : 清單中物件 增 / 減  
  增加時 **不會** 清空，物件會 **依選取順序** 添加在最後，若有選到清單中已經存在的物件，也會依照順序放到清單最後，增加的方式與上面要介紹的 A 的增加方式有所不同，刪減的部分也與 1-J 有所差異  
  <br>

- E : 清單功能 ( 下拉選單 )  
  詳情見 [1-1 清單功能](#1-1-清單功能)
  <br>

- F : 清單中選取物件 上移 / 下移  
  手動調整排序，若有使用此功能調動順序，調整後的結果就會被定義為 **" 原始順序 "**
  <br>

- G : 推送動畫至 NLA ( 下拉選單 )  
  只針對清單中的物件做轉換。
  <br>  
  
-  PS. [3.清單中內容說明](#3-清單中的圖示意義)

#### 1-1. 清單功能

![alt text](images/img_2002.png)

- H : 初始並加入所選   
  會清空清單資料後再添加 場景 中所選的物件
  <br>

- I : 四種排序    
  最重要的是 **原始順序** 本外掛會記錄該順序，另外三個都是
  <br>

- J : 移除場景中所選物件   
  是針對場景中所選定的物件，與 1-D 的移除，有所不同。
  <br>

#### 2. 資料定位

![alt text](images/img_2003.png)

- K : 三種定位模式  
  - 單一片段 : 只針對一段片段做改變
  - 單一軌道 : 會把一條軌道上的所有片段看成是一整段  ( 相對位置不會變 )
  - 所有軌道 : 等同於是物件中的所有軌道一起改變 ( 相對位置不會變 )
  <br>

- L : 三個定位點  
  - 哪個槽位 : 只有材質模式才有，在 NLA 介面中是 **由上而下** 計算
  - 第幾軌道 : 在 NLA 介面中是 **由下而上** 計算
  - 第幾片段 : 在 NLA 介面中是 **由左至右** 計算
  <br>

  **!! 注意 : 沒有真正定位到目標，NLA 會無法錯位**

#### 3. NLA 對齊工具 ( 初始化數值 )
![alt text](images/img_2004.png)

- M : 五種定位目標  
  - 依最大開始幀 : 清單中的 NLA 中最 **晚** 開始的片段之 **開頭** 為準
  - 依最小開始幀 : 清單中的 NLA 中最 **早** 開始的片段之 **開頭** 為準 ( 常用 )
  - 依最大結束幀 : 清單中的 NLA 中最 **晚** 結束的片段之 **結尾** 為準 ( 常用 )
  - 依最小結束幀 : 清單中的 NLA 中最 **早** 結束的片段之 **結尾** 為準
  - 依目前播放幀 : 依目前播放幀為準 (最常用)
  <br>

- N : 三種對其方式  
  - 對齊左 : 依照目標向左靠齊，常用於 **開始** 的目標對齊
  - 齊中間 : 依照目標向中央對齊
  - 對齊右 : 依照目標向右靠齊，常用於 **結束** 的目標對齊
  <br>

- O : 重設縮放  
  將清單中所有 NLA 的片段縮放值，回歸到數值 1
  <br>


#### 4. 簡易模式

![alt text](images/img_2005.png)  
- P : 錯位模式 [( 詳細說明 )](#2-錯位說明)  
  錯位計算公式共有四種 : 1.線性 / 2.緩入 / 3.緩出 / 4.淡入淡出
  <br>

- Q : 錯位差距 ( 單位 **幀** )  
  不是片段的等距差，而是列表第一個物件，與最後一個物件的差 ( 可以輸入負數 )
  <br>

- R : 錯位縮放  
  不是片段的等距縮放，而是列表第一個物件，與最後一個物件的縮放差 ( 0 ~ 1 )
  <br>

- S : 執行簡易模式中的參數來達到錯位 ( 一直按會累加計算 )
  <br>

#### 5. 專業模式
![alt text](images/img_2006.png)  
  **>> 本外掛最重要的核心，只要簡單設定，片段的錯位與縮放會自動調整 <<**

- T : 錯位模式 [( 詳細說明 )](#2-錯位說明)  
  錯位計算公式共有四種 : 1.線性 / 2.緩入 / 3.緩出 / 4.淡入淡出
  <br>

- U : 動畫起始點  
  設定整段動畫，也就是清單中所有物件的動畫表演 **開始** 時間
  <br>

- V : 起始錯位比例    
  與 錯位模式 ( T )相乘出的錯位量，用於 自動化設定所有片段的起始點
  <br>

- W : 錯位模式 [( 詳細說明 )](#2-錯位說明)    
  錯位計算公式共有四種 : 1.線性 / 2.緩入 / 3.緩出 / 4.淡入淡出
  <br>

- X : 動畫結束點    
  設定整段動畫，也就是清單中所有物件的動畫表演 **結束** 時間
  <br>

- Y : 結束錯位比例    
  不是片段的等距差，而是列表第一個物件，與最後一個物件的差 ( 可以入負數 )
  <br>

- Z : 執行專業模式中的參數 達到錯位 ( 一直按 **不會** 累加計算 )
  <br>


---

## ❓ 常見問題


#### 1. ⚠️ 注意「實例化資料（Instanced Data）」的細節

本外掛主要針對 NLA 片段（Strips）本身進行錯位與對齊處理，  
並 **不會** 自動處理 Blender 的「實例化資料」關係。

#### 什麼是實例化資料？

當**多個物件共用同一份資料**時，這些資料就是「實例化（Instanced）」的。

- 例如：  
  - 兩個物件共用同一個材質球  
  - 或共用同一個動畫、網格、或其他資料區塊  

在NLA 編輯器中看起來像是兩條獨立片段，但實際上**背後指向的是同一份資料**。
結果就是，在這種情況下使用 **NLA Stride 進行錯位**時，外掛看似在移動不同片段，但實際上仍在影響同一份資料，因此**無法達成你預期的錯位效果**。


#### ✅ 解決方式（ 搭配下方截圖操作 ）

> 💡 **關鍵做法：先將資料獨立化，再進行錯位**

步驟如下（ 如圖所示 ）：

1. 在 3D 視窗中選取需要處理的物件  
2. 開啟 **物件 → 關聯資料（Relations）**  
3. 點擊 **使單一使用者（Make Single User）**  
4. 依需求選取需要獨立的資料類型
5. 確認資料已獨立後，再使用 **NLA Stride** 進行錯位  



![alt text](images/img_3001.png)

> 資料獨立後，每個物件都會擁有「真正獨立的 NLA 資料」
> NLA Stride 即可 **正常、可預期地錯位 NLA 片段** 。
---


#### 2. ⚠️大量建立 NLA

本外掛主要針對 NLA 片段（Strips）本身進行錯位與對齊處理，所以非 NLA 片段的動畫，不會有所改變。

#### ✅ 解決方式 : 大量轉換工具

外掛將針對清單中的物件，做一次性的大量轉換 ( 下圖綠色箭頭 )，請特別注意是 **清單中** 而非 3D檢視中選到的物件。

![alt text](images/img_3002.png)

---



## 📖 其他說明


#### 1. 對齊與錯位策略小技巧

- 可以在 3D 檢視中 按 **Alt A** 取消所有選取後，再用 **選取清單物件** 功能，確認清單中到底選了那些物件。  
<br>

- 因為 **順序** 很重要，他直接影響錯位後的動畫狀態，如果可以請用名稱決定順序，倘若物件真的很多，也可以分批處理。  
<br>

- 當狀況變的混亂，可以用對齊工具先統一回來  
<br>

- 因為動畫錯位將變得很簡單，所以請專注建立一段  **完美的動態**。  
<br>

- 動作設計上 如果有設定到 **位置** 在複製時，要注意，播放動畫，會跳回到同一位置，因為位置資訊被寫入到 NLA 中，這時候我們可以用套用 **ctrl A** 功能，將新的位置寫入到 **增減變換** 資料中  
  <br>![alt text](images/img_4001.png)  

---

#### 2. 錯位說明
- 線性疊加模式 :  
  - 簡易模式 :   
  <a href="images/img_4002.png"><img src="images/img_4002.png" width="650"></a>  
  簡易模式會以原本的狀態 (如上圖最左邊) 疊加模式計算，如圖 錯位與縮放的數值設定 :錯位 100、縮放 1.5 ，最後一個片段的起始點 與長度(也可以說是結束點) 一定都會一樣；但可以看到因為疊加模式的不同，造成其他片段的起始點不同，造成不同的錯位感覺。

    ---
  - 專業模式 :    
  <a href="images/img_4003.png"><img src="images/img_4003.png" width="650"></a>  
  與簡易模式只差異於，專業模式可以設定控制 頭 與 尾，所以有多一個 疊加模式可以分別設定  
  
    ---
  - **注意** :   
  <a href="images/img_4004.png"><img src="images/img_4004.png" width="650"></a>  
  要注意頭尾的兩種疊加模式如果 **不同**，需要注意動畫片段會不會有問題
    ( 過短或是消失 )。
---

#### 3. 清單中的圖示意義

![alt text](images/img_3003.gif)

圖 A : 資料模式
圖 B : Action 代表一般的 動畫資料 (非 NLA 的動畫資料)
圖 C : 可用 NLA 資料

- 圖 B 與 圖 C 中的圖示意義，會因為 A欄中的 資料模式而改變 :
  - ✔ : 有符合 A 欄中設定的 **正確** 資料
  - ・: 有資料，但 **不是** A 欄中設定的資料
  - ✕ : 沒有資料

畫面中的資料 :
| 項目 | 物件動畫 | 材質動畫 | 外形鍵動畫 |
|------|------|------|--------|
| **NLA 片段** | cube.049 | cube.050 | cube.051 | 
| **作用中動作** | cube.027 | cube.037 | cube.038 | 

- 其他 : cube.000 ( 3 種類型的 NLA 全都有 )   /   cube.039 ( 完全沒有動畫資料 )

---




## 🔧 技術參考

  [Blender NLA 官方手冊](https://docs.blender.org/manual/en/latest/editors/nla/index.html)

  [Blender API 官方手冊](https://docs.blender.org/api/current/bpy.ops.nla.html)

  


## 📘 目錄

1. [快速開始](#-快速開始) 
2. [版更重點](#-版本更新重點) 
3. [功能總覽](#-功能總覽)      
4. [常見問題](#-常見問題) 
5. [其他](#-其他) 
6. [技術參考](#-技術參考)

<!-- 手冊結束 -->

